
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>preprocessing &#8212; FIFA_Preprocessing 0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for preprocessing</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;This module provides methods conceived to preprocess data stored</span>
<span class="sd">in a csv file etc., with the intent to perform data analysis and</span>
<span class="sd">Machine Learning.</span>

<span class="sd">It was originally created to preprocess data from the EA Sports&#39;</span>
<span class="sd">FIFA 19 for a Machine Learning project to predictplayers&#39; wages</span>
<span class="sd">by regression. Therefore it contains functions that can be</span>
<span class="sd">universally used for data preprocessing but also functions that</span>
<span class="sd">are made specifically with the FIFA 19 data set in mind.</span>

<span class="sd">This module requires that `pandas` be installed within the Python</span>
<span class="sd">environment this module is being run in.</span>

<span class="sd">If run as main or using demo function, this module also requires</span>
<span class="sd">that `matplotlib.pyplot` be installed.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">read_fifa()</span>
<span class="sd">    Read the FIFA 19 data set.</span>
<span class="sd">exclude_goalkeepers(data_frame)</span>
<span class="sd">    Delete goalkeepers from the data.</span>
<span class="sd">money_format(money)</span>
<span class="sd">    Return integer value of the monetary amount.</span>
<span class="sd">rating_format(rating)</span>
<span class="sd">    Express rating string as an integer.</span>
<span class="sd">work_format(work)</span>
<span class="sd">    Code amplitude string as an integer.</span>
<span class="sd">to_int(not_int)</span>
<span class="sd">    Floor floating point numbers.</span>
<span class="sd">apply_format(data_frame, column_names, format_method)</span>
<span class="sd">    Apply `format_method` to `data_frame` columns.</span>
<span class="sd">to_dummy(data_frame, column_names)</span>
<span class="sd">    Dummy code categorical variables.</span>
<span class="sd">split_work_rate(data_frame)</span>
<span class="sd">    Split the players&#39; work rate column.</span>
<span class="sd">preprocess(source_file)</span>
<span class="sd">    Preprocess the FIFA 19 data from the path by default.</span>
<span class="sd">demo()</span>
<span class="sd">    Demonstrate basic use of the module.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<div class="viewcode-block" id="read_fifa"><a class="viewcode-back" href="../preprocessing.html#preprocessing.read_fifa">[docs]</a><span class="k">def</span> <span class="nf">read_fifa</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the FIFA 19 data set.</span>

<span class="sd">    Read &quot;fifa19_data.csv&quot; containing the FIFA 19 data set into a  DataFrame</span>
<span class="sd">    object and return it.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas.DataFrame</span>
<span class="sd">        DataFrame containing FIFA 19 data set.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    About fifa19_data.csv file</span>
<span class="sd">    fifa19_data.csv includes lastest edition FIFA 2019 players attributes like Age,</span>
<span class="sd">    Nationality, Overall, Potential, Club, Value, Wage, Preferred Foot, International</span>
<span class="sd">    Reputation, Weak Foot, Skill Moves, Work Rate, Position, Jersey Number, Joined,</span>
<span class="sd">    Loaned From, Contract Valid Until, Height, Weight, LS, ST, RS, LW, LF, CF, RF, RW,</span>
<span class="sd">    LAM, CAM, RAM, LM, LCM, CM, RCM, RM, LWB, LDM, CDM, RDM, RWB, LB, LCB, CB, RCB, RB,</span>
<span class="sd">    Crossing, Finishing, Heading, Accuracy, ShortPassing, Volleys, Dribbling, Curve,</span>
<span class="sd">    FKAccuracy, LongPassing, BallControl, Acceleration, SprintSpeed, Agility, Reactions,</span>
<span class="sd">    Balance, ShotPower, Jumping, Stamina, Strength, LongShots, Aggression, Interceptions,</span>
<span class="sd">    Positioning, Vision, Penalties, Composure, Marking, StandingTackle, SlidingTackle,</span>
<span class="sd">    GKDiving, GKHandling, GKKicking, GKPositioning, GKReflexes, and Release Clause.</span>
<span class="sd">    More information about the data can be found in the source [1].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    [1] This data set was scraped from https://www.kaggle.com/karangadiya/fifa19.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;fifa19_data.csv&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="exclude_goalkeepers"><a class="viewcode-back" href="../preprocessing.html#preprocessing.exclude_goalkeepers">[docs]</a><span class="k">def</span> <span class="nf">exclude_goalkeepers</span><span class="p">(</span><span class="n">data_frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove goalkeepers and return the DataFrame.</span>

<span class="sd">    Go through the `data_frame` find all the tuples with the players&#39;</span>
<span class="sd">    Position column set to &quot;GK&quot; and remove them. Return the `data_frame`</span>
<span class="sd">    with no goalkeeper tuples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        DataFrame containing FIFA19 data set including goalkeepers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        DataFrame containing FIFA19 data set with goalkeepers&#39; tuples</span>
<span class="sd">        removed.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function can be used when preprocessing the FIFA19 dataset to</span>
<span class="sd">    perform Machine Learning as a goalkeeper is a peculiar player  and</span>
<span class="sd">    all his properties vary compared to other positions on the field.</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = pandas.read_csv(&quot;fifa19_data.csv&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(data[[&#39;Name&#39;, &#39;Position&#39;]])</span>
<span class="sd">                           Name Position</span>
<span class="sd">    0                  L. Messi       RF</span>
<span class="sd">    1         Cristiano Ronaldo       ST</span>
<span class="sd">    2                 Neymar Jr       LW</span>
<span class="sd">    3                    De Gea       GK</span>
<span class="sd">    4              K. De Bruyne      RCM</span>
<span class="sd">                            ...      ...</span>
<span class="sd">    18206             G. Nugent       CM</span>
<span class="sd">    [18207 rows x 2 columns]</span>
<span class="sd">    &gt;&gt;&gt; data = exclude_goalkeepers(data)</span>
<span class="sd">    &gt;&gt;&gt; print(data[[&#39;Name&#39;, &#39;Position&#39;]])</span>
<span class="sd">                           Name Position</span>
<span class="sd">    0                  L. Messi       RF</span>
<span class="sd">    1         Cristiano Ronaldo       ST</span>
<span class="sd">    2                 Neymar Jr       LW</span>
<span class="sd">    4              K. De Bruyne      RCM</span>
<span class="sd">                            ...      ...</span>
<span class="sd">    18206             G. Nugent       CM</span>

<span class="sd">    [16182 rows x 2 columns]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">goalkeepers</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">[</span><span class="n">data_frame</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;GK&#39;</span><span class="p">]</span>
    <span class="n">data_frame</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">goalkeepers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_frame</span></div>


<div class="viewcode-block" id="money_format"><a class="viewcode-back" href="../preprocessing.html#preprocessing.money_format">[docs]</a><span class="k">def</span> <span class="nf">money_format</span><span class="p">(</span><span class="n">money</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the integer value of a monetary amount string.</span>
<span class="sd">    </span>
<span class="sd">    Remove euro currency sign from `money` and letters expressing the</span>
<span class="sd">    order of magnitude from the passed in string, e.g. &quot;K&quot; for thousands</span>
<span class="sd">    and &quot;M&quot; for milions. Cast the string into an integer. Returned values</span>
<span class="sd">    are expressed in thousands of euros.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    money : str</span>
<span class="sd">        String containing monetary amount with a currency sign and</span>
<span class="sd">        order of magnitude abbreviation.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    money : int</span>
<span class="sd">        Integer value of the monetary amount.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; v = money_format(&quot;€500K&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(v)</span>
<span class="sd">    500</span>

<span class="sd">    &gt;&gt;&gt; v = money_format(&quot;€70.5M)&quot;</span>
<span class="sd">    &gt;&gt;&gt; print(v)</span>
<span class="sd">    70500</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">money</span> <span class="o">=</span> <span class="n">money</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;€&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">money</span><span class="p">:</span>
        <span class="n">money</span> <span class="o">=</span> <span class="n">money</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">money</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">money</span> <span class="o">=</span> <span class="n">money</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">money</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="rating_format"><a class="viewcode-back" href="../preprocessing.html#preprocessing.rating_format">[docs]</a><span class="k">def</span> <span class="nf">rating_format</span><span class="p">(</span><span class="n">rating</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return an integer equal to the string represented sum.</span>

<span class="sd">    Cast a string expressing a sum of integers delimited by a plus sign,</span>
<span class="sd">    e.g. 81+3, into an integer equal to a sum of the two numbers and</span>
<span class="sd">    return the integer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rating : str</span>
<span class="sd">        String representing a sum of two integers with a plus sign</span>
<span class="sd">        inbetween.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rating : int</span>
<span class="sd">        Integer value of the sum of the numbers. Integer is equal to zero</span>
<span class="sd">        if the type of the input is not string.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function is used in the FIFA19 data set to convert the player&#39;s</span>
<span class="sd">    special rating format in the game to an integer to get the proper</span>
<span class="sd">    understanding of the data when performing Machine Learning.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; r = rating_format(&quot;81+3&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(r)</span>
<span class="sd">    84</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">rating</span><span class="p">:</span>
        <span class="n">plus</span> <span class="o">=</span> <span class="n">rating</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rating</span><span class="p">[:</span><span class="n">plus</span><span class="p">])</span>
        <span class="n">add</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="n">plus</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">base</span> <span class="o">+</span> <span class="n">add</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span></div>


<div class="viewcode-block" id="work_format"><a class="viewcode-back" href="../preprocessing.html#preprocessing.work_format">[docs]</a><span class="k">def</span> <span class="nf">work_format</span><span class="p">(</span><span class="n">work</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a numerical interpretation of a categorical variable.</span>

<span class="sd">    Take in a string representing a categorical variable representing</span>
<span class="sd">    an amplitude of a phenomenon as &quot;High&quot;, &quot;Medium&quot; and any other word,</span>
<span class="sd">    e.g. &quot;Low&quot;, and return an integer representing the amplitude: 2, 1, 0</span>
<span class="sd">    respectively.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    work : str</span>
<span class="sd">        String representing a categorical variable.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        Integer value of the work rate: 0, 1 or 2.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function is used on the FIFA19 data set to convert the description</span>
<span class="sd">    of player&#39;s work rate (&quot;High&quot;, &quot;Medium&quot; and &quot;Low&quot;) into an integer in</span>
<span class="sd">    order to enable some of the Machine Learning algorithms to make use of</span>
<span class="sd">    the properties.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; w = work_format(&quot;High&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(w)</span>
<span class="sd">    2</span>

<span class="sd">    &gt;&gt;&gt; w = work_format(&quot;Low&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(w)</span>
<span class="sd">    0</span>

<span class="sd">    &gt;&gt;&gt; w = work_format(&quot;Poor&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(w)</span>
<span class="sd">    0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">work</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">work</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="to_int"><a class="viewcode-back" href="../preprocessing.html#preprocessing.to_int">[docs]</a><span class="k">def</span> <span class="nf">to_int</span><span class="p">(</span><span class="n">not_int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the integer value of a floating point number.</span>
<span class="sd">    </span>
<span class="sd">    Return the floored integer value of a floating point number. Return</span>
<span class="sd">    0 if `not_int` is a NaN.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    not_int : not_integer</span>
<span class="sd">        Not_integer means all those types -- float, NaN -- to be converted</span>
<span class="sd">        into an integer.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">	Integer value of the parameter.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.nan : Nan stands for: not a number.</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; n = to_int(17.5)</span>
<span class="sd">    &gt;&gt;&gt; print(n)</span>
<span class="sd">    17</span>

<span class="sd">    &gt;&gt;&gt; n = to_int(numpy.nan)</span>
<span class="sd">    &gt;&gt;&gt; print(n)</span>
<span class="sd">    0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">not_int</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">not_int</span><span class="p">)</span></div>


<div class="viewcode-block" id="apply_format"><a class="viewcode-back" href="../preprocessing.html#preprocessing.apply_format">[docs]</a><span class="k">def</span> <span class="nf">apply_format</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">format_method</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply a formatting function to a DataFrame column and return.</span>

<span class="sd">    Simplify applying format modifications to the data stored in columns</span>
<span class="sd">    of `data_frame`. Check if the parameters are of the right type, apply</span>
<span class="sd">    `format_method` to the columns of `data_frame` whose labels are passed</span>
<span class="sd">    in `column names`. Return the DataFrame with the applied changes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        DataFrame containing the data to be modified.</span>
<span class="sd">    column_names : list</span>
<span class="sd">        List of string labels of columns in `data_frame` to be modified.</span>
<span class="sd">    format_method : function</span>
<span class="sd">        Function to be applied to the columns of `data_frame`, whose labels</span>
<span class="sd">        are listed in `column_names`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        The passed in DataFrame with the formatting changes applied to</span>
<span class="sd">        its columns.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pandas.apply</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = pandas.read_csv(&quot;fifa19_data.csv&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(data[&#39;Wage&#39;])</span>
<span class="sd">    0        €565K</span>
<span class="sd">    1        €405K</span>
<span class="sd">             ...</span>
<span class="sd">    18205      €1K</span>
<span class="sd">    18206      €1K</span>
<span class="sd">    Name: Wage, Length: 18207, dtype: object</span>
<span class="sd">    &gt;&gt;&gt; data = apply_format(data, [&#39;Wage&#39;], money_format)</span>
<span class="sd">    &gt;&gt;&gt; print(data[&#39;Wage&#39;])</span>
<span class="sd">    0        565</span>
<span class="sd">    1        405</span>
<span class="sd">            ...</span>
<span class="sd">    18205      1</span>
<span class="sd">    18206      1</span>
<span class="sd">    Name: Wage, Length: 18207, dtype: int64</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">column</span> <span class="ow">in</span> <span class="n">data_frame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">format_method</span><span class="p">):</span>
            <span class="n">data_frame</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">format_method</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_frame</span></div>


<div class="viewcode-block" id="to_dummy"><a class="viewcode-back" href="../preprocessing.html#preprocessing.to_dummy">[docs]</a><span class="k">def</span> <span class="nf">to_dummy</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">column_names</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the DataFrame with dummy coded categorical variables.</span>

<span class="sd">    Add dummy coded categorical variables columns of `data_frame`. Remove</span>
<span class="sd">    the categorical variable columns. Return the modified DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        DataFrame containing the data to be dummy coded.</span>
<span class="sd">    column_names : list</span>
<span class="sd">        List of string labels of columns in `data_frame` to be dummy coded.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        The passed in DataFrame with the dummy coded categorical variables.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pandas.get_dummies, pandas.concat</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Thanks to dummy coding, statistical analysis may be performed on</span>
<span class="sd">    categorical data.</span>

<span class="sd">    [1] &quot;Dummy coding refers to the process of coding a categorical</span>
<span class="sd">    variable into dichotomous variables. For example, we may have data</span>
<span class="sd">    about participants&#39; religion, with each participant coded as follows:</span>

<span class="sd">        A categorical or nominal variable with three categories</span>

<span class="sd">                        Religion	Code</span>
<span class="sd">                        Christian	1</span>
<span class="sd">                        Muslim		2</span>
<span class="sd">                        Atheist		3</span>

<span class="sd">    This is a nominal variable (see level of measurement) which would be</span>
<span class="sd">    inappropriate as a predictor in MLR. However, this variable could be</span>
<span class="sd">    represented using a series of three dichotomous variables (coded as</span>
<span class="sd">    0 or 1), as follows:</span>

<span class="sd">        Full dummy coding for a categorical variable with three categories</span>

<span class="sd">                Religion	Christian	Muslim	Atheist</span>
<span class="sd">                Christian	1		0	0</span>
<span class="sd">                Muslim		0		1	0</span>
<span class="sd">                Atheist		0		0	1	&quot;</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    [1] https://en.wikiversity.org/wiki/Dummy_variable_(statistics)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data_frame</span><span class="p">:</span>
            <span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data_frame</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">dummies</span><span class="p">])</span>
            <span class="n">data_frame</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_frame</span></div>


<div class="viewcode-block" id="split_work_rate"><a class="viewcode-back" href="../preprocessing.html#preprocessing.split_work_rate">[docs]</a><span class="k">def</span> <span class="nf">split_work_rate</span><span class="p">(</span><span class="n">data_frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split &#39;Work Rate&#39; column into two and return the DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Split &#39;Work Rate&#39; column of `data_frame` into &#39;Defensive Work Rate&#39;</span>
<span class="sd">    and &#39;Offensive Work Rate&#39;, apply `work_format` function to the </span>
<span class="sd">    columns and return the modified DataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        DataFrame containing a &#39;Work Rate&#39; column to be split.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data_frame : pandas.DataFrame</span>
<span class="sd">        The DataFrame with the &#39;Work Rate&#39; column split into formatted</span>
<span class="sd">        defensive and offensive work rate columns.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    apply_format, work_format</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function can be used to split and format work rate column into</span>
<span class="sd">    defensive and offensive work rates of a player as they are stored in</span>
<span class="sd">    one column in the FIFA19 data set.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = pandas.read_csv(&quot;fifa19_data.csv&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(data[&#39;Work Rate&#39;])</span>
<span class="sd">    0        Medium/ Medium</span>
<span class="sd">    1             High/ Low</span>
<span class="sd">    2          High/ Medium</span>
<span class="sd">                    ...</span>
<span class="sd">    &gt;&gt;&gt; data = split_work_rate(data)</span>
<span class="sd">    &gt;&gt;&gt; print(data[[&#39;Defensive Work Rate&#39;, &#39;Offensive Work Rate&#39;]])</span>
<span class="sd">           Defensive Work Rate  Offensive Work Rate</span>
<span class="sd">    0                        1                    1</span>
<span class="sd">    1                        2                    0</span>
<span class="sd">    2                        2                    1</span>
<span class="sd">                           ...                  ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_frame</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Work Rate&#39;</span><span class="p">:</span> <span class="s1">&#39;Work&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_frame</span><span class="p">[[</span><span class="s1">&#39;Defensive Work Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Offensive Work Rate&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">Work</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/ &#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data_frame</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Work&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Defensive Work Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Offensive Work Rate&#39;</span><span class="p">],</span> <span class="n">work_format</span><span class="p">)</span></div>


<div class="viewcode-block" id="preprocess"><a class="viewcode-back" href="../preprocessing.html#preprocessing.preprocess">[docs]</a><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Preprocess data to enable its analysis.</span>

<span class="sd">    Perform optimal preprocessing on the FIFA 19 data set. Drop irrelevant</span>
<span class="sd">    attributes. Convert attribute types, e.g. categorical data into numerical</span>
<span class="sd">    or floating point numbers carrying integers into integers. Manage column</span>
<span class="sd">    representation of attributes. Return the preprocessed DataFrame,</span>
<span class="sd">    ready to perform data analysis on it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pandas.DataFrame</span>
<span class="sd">        Data to preprocess.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : pandas.DataFrame</span>
<span class="sd">        Preprocessed data, ready to perform analysis on it.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pandas.DataFrame.drop, pandas.DataFrame.dropna, pandas.read_csv</span>
<span class="sd">    exclude_goalkeepers, apply_format, money_format, to_int,</span>
<span class="sd">    to_dummy, split_work_rate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Drop useless attributes.</span>
    <span class="c1"># Unnamed: 0 is an index (0 - n).</span>
    <span class="c1"># ID is FIFA19&#39;s internal id.</span>
    <span class="c1"># Photo, Flag and Club Logo are images.</span>
    <span class="c1"># Real Face - Yes/No value if the game uses a 3D scan of the actual face of the player.</span>
    <span class="c1"># Loaned From is usually missing, duration of the contract and</span>
    <span class="c1"># date of joining the club are not essential.</span>
    <span class="c1"># Name and body parameters are not correlated to wage.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Photo&#39;</span><span class="p">,</span> <span class="s1">&#39;Flag&#39;</span><span class="p">,</span> <span class="s1">&#39;Club Logo&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Loaned From&#39;</span><span class="p">,</span> <span class="s1">&#39;Height&#39;</span><span class="p">,</span> <span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Body Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Real Face&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;Joined&#39;</span><span class="p">,</span> <span class="s1">&#39;Contract Valid Until&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Exclude goalkeepers as they constitute a special class of players and may</span>
    <span class="c1">#  confuse algorithms analyzing it.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">exclude_goalkeepers</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    
    <span class="c1"># Compute ratings on specific positions on the field and on football skills.</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">41</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">rating_format</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">41</span><span class="p">:</span><span class="mi">75</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">to_int</span><span class="p">)</span>

    <span class="c1"># Drop rows with missing values.</span>
    <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Convert monetary amounts.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Wage&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Release Clause&#39;</span><span class="p">],</span> <span class="n">money_format</span><span class="p">)</span>

    <span class="c1"># Convert floats to int as the nature of this information (&#39;Jersey Number&#39;,</span>
    <span class="c1"># &#39;International Reputation&#39;, &#39;Skill Moves&#39;, &#39;Weak Foot&#39;) is discrete.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Jersey Number&#39;</span><span class="p">,</span> <span class="s1">&#39;International Reputation&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Skill Moves&#39;</span><span class="p">,</span> <span class="s1">&#39;Weak Foot&#39;</span><span class="p">],</span> <span class="n">to_int</span><span class="p">)</span>

    <span class="c1"># Convert categorical data to dummy variables in order to enable its analysis.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">to_dummy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Preferred Foot&#39;</span><span class="p">,</span> <span class="s1">&#39;Club&#39;</span><span class="p">,</span> <span class="s1">&#39;Position&#39;</span><span class="p">,</span> <span class="s1">&#39;Nationality&#39;</span><span class="p">])</span>

    <span class="c1"># Split work rate into defensive and offensive work rate.</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">split_work_rate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="demo"><a class="viewcode-back" href="../preprocessing.html#preprocessing.demo">[docs]</a><span class="k">def</span> <span class="nf">demo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Demonstrate basic use of the module, use preprocess and plot a simple relation.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">read_fifa</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># Relation Between Jersey Number and Wage of a Player</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Wage&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Jersey Number&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Relation Between Jersey Number and Wage of a Player&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wage [k€]&#39;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">demo</span><span class="p">()</span>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">FIFA_Preprocessing</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">sphinx</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Piotr Frątczak, Jakub Płudowski.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>